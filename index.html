<!DOCTYPE html>
<html>
<head>
    <title>unix Time</title>
</head>
<body>
    <div id="UNIXtime">Loading...</div>
    <div id="offset">offset...</div>
    <script>
        let timeOffset = 0;

        // サーバー時刻を取得してオフセットを計算
        fetch("https://worldtimeapi.org/api/timezone/Etc/UTC")
        .then(response => response.json())
        .then(data => {
            const serverUnixTime = new Date(data.utc_datetime).getTime();
            const deviceUnixTime = Date.now();
            timeOffset = serverUnixTime - deviceUnixTime; // サーバー時間とデバイス時間の差分
            document.getElementById("offset").textContent = "サーバーとデバイスの時間誤差" + timeOffset + " ms";
            correctedTime();
        });

        function correctedTime() {
            const now = Date.now(); // デバイスの現在時刻
            const syncedUnixTime = now + timeOffset; // オフセットで補正した時刻
            document.getElementById("UNIXtime").textContent = syncedUnixTime;
            requestAnimationFrame(correctedTime);
        }
    </script>
</body>
</html>
